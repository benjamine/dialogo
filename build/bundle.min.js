!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.dialogo=t()}}(function(){return function t(e,n,r){function i(o,a){if(!n[o]){if(!e[o]){var f="function"==typeof require&&require;if(!a&&f)return f(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var l=n[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!i(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,i,a,f,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length))throw e=arguments[1],e instanceof Error?e:TypeError('Uncaught, unspecified "error" event.');if(n=this._events[t],o(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),f=1;i>f;f++)a[f-1]=arguments[f];n.apply(this,a)}else if(s(n)){for(i=arguments.length,a=new Array(i-1),f=1;i>f;f++)a[f-1]=arguments[f];for(l=n.slice(),i=l.length,f=0;i>f;f++)l[f].apply(this,a)}return!0},n.prototype.addListener=function(t,e){var i;if(!r(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned){var i;i=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),i||(i=!0,e.apply(this,arguments))}if(!r(e))throw TypeError("listener must be a function");var i=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,i,o,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],o=n.length,i=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=o;a-->0;)if(n[a]===e||n[a].listener&&n[a].listener===e){i=a;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],r(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?r(t._events[e])?1:t._events[e].length:0}},{}],2:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],3:[function(t,e){function n(){}var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(t,e){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],5:[function(t,e,n){(function(e,r){function i(t,e){var r={seen:[],stylize:o};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(e)?r.showHidden=e:e&&n._extend(r,e),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),f(r,t,r.depth)}function s(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function o(t){return t}function a(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function f(t,e,r){if(t.customInspect&&e&&E(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return _(i)||(i=f(t,i,r)),i}var s=l(t,e);if(s)return s;var o=Object.keys(e),g=a(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),C(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(e);if(0===o.length){if(E(e)){var v=e.name?": "+e.name:"";return t.stylize("[Function"+v+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(M(e))return t.stylize(Date.prototype.toString.call(e),"date");if(C(e))return h(e)}var m="",y=!1,b=["{","}"];if(d(e)&&(y=!0,b=["[","]"]),E(e)){var x=e.name?": "+e.name:"";m=" [Function"+x+"]"}if(w(e)&&(m=" "+RegExp.prototype.toString.call(e)),M(e)&&(m=" "+Date.prototype.toUTCString.call(e)),C(e)&&(m=" "+h(e)),0===o.length&&(!y||0==e.length))return b[0]+m+b[1];if(0>r)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var R;return R=y?u(t,e,r,g,o):o.map(function(n){return c(t,e,r,g,n,y)}),t.seen.pop(),p(R,m,b)}function l(t,e){if(x(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function u(t,e,n,r,i){for(var s=[],o=0,a=e.length;a>o;++o)s.push(P(e,String(o))?c(t,e,n,r,String(o),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||s.push(c(t,e,n,r,i,!0))}),s}function c(t,e,n,r,i,s){var o,a,l;if(l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},l.get?a=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),P(r,i)||(o="["+i+"]"),a||(t.seen.indexOf(l.value)<0?(a=v(n)?f(t,l.value,null):f(t,l.value,n-1),a.indexOf("\n")>-1&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),x(o)){if(s&&i.match(/^\d+$/))return a;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function p(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function v(t){return null===t}function m(t){return null==t}function y(t){return"number"==typeof t}function _(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function x(t){return void 0===t}function w(t){return R(t)&&"[object RegExp]"===j(t)}function R(t){return"object"==typeof t&&null!==t}function M(t){return R(t)&&"[object Date]"===j(t)}function C(t){return R(t)&&("[object Error]"===j(t)||t instanceof Error)}function E(t){return"function"==typeof t}function A(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function j(t){return Object.prototype.toString.call(t)}function D(t){return 10>t?"0"+t.toString(10):t.toString(10)}function S(){var t=new Date,e=[D(t.getHours()),D(t.getMinutes()),D(t.getSeconds())].join(":");return[t.getDate(),F[t.getMonth()],e].join(" ")}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var T=/%[sdj%]/g;n.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,s=r.length,o=String(t).replace(T,function(t){if("%%"===t)return"%";if(n>=s)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),a=r[n];s>n;a=r[++n])o+=v(a)||!R(a)?" "+a:" "+i(a);return o},n.deprecate=function(t,i){function s(){if(!o){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),o=!0}return t.apply(this,arguments)}if(x(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(e.noDeprecation===!0)return t;var o=!1;return s};var k,N={};n.debuglog=function(t){if(x(k)&&(k=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!N[t])if(new RegExp("\\b"+t+"\\b","i").test(k)){var r=e.pid;N[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else N[t]=function(){};return N[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=g,n.isNull=v,n.isNullOrUndefined=m,n.isNumber=y,n.isString=_,n.isSymbol=b,n.isUndefined=x,n.isRegExp=w,n.isObject=R,n.isDate=M,n.isError=C,n.isFunction=E,n.isPrimitive=A,n.isBuffer=t("./support/isBuffer");var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",S(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!R(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("1YiZ5S"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":4,"1YiZ5S":3,inherits:2}],6:[function(){function t(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var e=-1,n=1,r=0;t.Diff,t.prototype.diff_main=function(t,e,n,i){"undefined"==typeof i&&(i=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var s=i;if(null==t||null==e)throw new Error("Null input. (diff_main)");if(t==e)return t?[[r,t]]:[];"undefined"==typeof n&&(n=!0);var o=n,a=this.diff_commonPrefix(t,e),f=t.substring(0,a);t=t.substring(a),e=e.substring(a),a=this.diff_commonSuffix(t,e);var l=t.substring(t.length-a);t=t.substring(0,t.length-a),e=e.substring(0,e.length-a);var h=this.diff_compute_(t,e,o,s);return f&&h.unshift([r,f]),l&&h.push([r,l]),this.diff_cleanupMerge(h),h},t.prototype.diff_compute_=function(t,i,s,o){var a;if(!t)return[[n,i]];if(!i)return[[e,t]];var f=t.length>i.length?t:i,l=t.length>i.length?i:t,h=f.indexOf(l);if(-1!=h)return a=[[n,f.substring(0,h)],[r,l],[n,f.substring(h+l.length)]],t.length>i.length&&(a[0][0]=a[2][0]=e),a;if(1==l.length)return[[e,t],[n,i]];f=l=null;var u=this.diff_halfMatch_(t,i);if(u){var c=u[0],p=u[1],d=u[2],g=u[3],v=u[4],m=this.diff_main(c,d,s,o),y=this.diff_main(p,g,s,o);return m.concat([[r,v]],y)}return s&&t.length>100&&i.length>100?this.diff_lineMode_(t,i,o):this.diff_bisect_(t,i,o)},t.prototype.diff_lineMode_=function(t,i,s){var o=this.diff_linesToChars_(t,i);t=o[0],i=o[1];var a=o[2],f=this.diff_bisect_(t,i,s);this.diff_charsToLines_(f,a),this.diff_cleanupSemantic(f),f.push([r,""]);for(var l=0,h=0,u=0,c="",p="";l<f.length;){switch(f[l][0]){case n:u++,p+=f[l][1];break;case e:h++,c+=f[l][1];break;case r:if(h>=1&&u>=1){var o=this.diff_main(c,p,!1,s);f.splice(l-h-u,h+u),l=l-h-u;for(var d=o.length-1;d>=0;d--)f.splice(l,0,o[d]);l+=o.length}u=0,h=0,c="",p=""}l++}return f.pop(),f},t.prototype.diff_bisect_=function(t,r,i){for(var s=t.length,o=r.length,a=Math.ceil((s+o)/2),f=a,l=2*a,h=new Array(l),u=new Array(l),c=0;l>c;c++)h[c]=-1,u[c]=-1;h[f+1]=0,u[f+1]=0;for(var p=s-o,d=p%2!=0,g=0,v=0,m=0,y=0,_=0;a>_&&!((new Date).getTime()>i);_++){for(var b=-_+g;_-v>=b;b+=2){var x,w=f+b;x=b==-_||b!=_&&h[w-1]<h[w+1]?h[w+1]:h[w-1]+1;for(var R=x-b;s>x&&o>R&&t.charAt(x)==r.charAt(R);)x++,R++;if(h[w]=x,x>s)v+=2;else if(R>o)g+=2;else if(d){var M=f+p-b;if(M>=0&&l>M&&-1!=u[M]){var C=s-u[M];if(x>=C)return this.diff_bisectSplit_(t,r,x,R,i)}}}for(var E=-_+m;_-y>=E;E+=2){var C,M=f+E;C=E==-_||E!=_&&u[M-1]<u[M+1]?u[M+1]:u[M-1]+1;for(var A=C-E;s>C&&o>A&&t.charAt(s-C-1)==r.charAt(o-A-1);)C++,A++;if(u[M]=C,C>s)y+=2;else if(A>o)m+=2;else if(!d){var w=f+p-E;if(w>=0&&l>w&&-1!=h[w]){var x=h[w],R=f+x-w;if(C=s-C,x>=C)return this.diff_bisectSplit_(t,r,x,R,i)}}}}return[[e,t],[n,r]]},t.prototype.diff_bisectSplit_=function(t,e,n,r,i){var s=t.substring(0,n),o=e.substring(0,r),a=t.substring(n),f=e.substring(r),l=this.diff_main(s,o,!1,i),h=this.diff_main(a,f,!1,i);return l.concat(h)},t.prototype.diff_linesToChars_=function(t,e){function n(t){for(var e="",n=0,s=-1,o=r.length;s<t.length-1;){s=t.indexOf("\n",n),-1==s&&(s=t.length-1);var a=t.substring(n,s+1);n=s+1,(i.hasOwnProperty?i.hasOwnProperty(a):void 0!==i[a])?e+=String.fromCharCode(i[a]):(e+=String.fromCharCode(o),i[a]=o,r[o++]=a)}return e}var r=[],i={};r[0]="";var s=n(t),o=n(e);return[s,o,r]},t.prototype.diff_charsToLines_=function(t,e){for(var n=0;n<t.length;n++){for(var r=t[n][1],i=[],s=0;s<r.length;s++)i[s]=e[r.charCodeAt(s)];t[n][1]=i.join("")}},t.prototype.diff_commonPrefix=function(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,s=0;i>n;)t.substring(s,i)==e.substring(s,i)?(n=i,s=n):r=i,i=Math.floor((r-n)/2+n);return i},t.prototype.diff_commonSuffix=function(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,s=0;i>n;)t.substring(t.length-i,t.length-s)==e.substring(e.length-i,e.length-s)?(n=i,s=n):r=i,i=Math.floor((r-n)/2+n);return i},t.prototype.diff_commonOverlap_=function(t,e){var n=t.length,r=e.length;if(0==n||0==r)return 0;n>r?t=t.substring(n-r):r>n&&(e=e.substring(0,n));var i=Math.min(n,r);if(t==e)return i;for(var s=0,o=1;;){var a=t.substring(i-o),f=e.indexOf(a);if(-1==f)return s;o+=f,(0==f||t.substring(i-o)==e.substring(0,o))&&(s=o,o++)}},t.prototype.diff_halfMatch_=function(t,e){function n(t,e,n){for(var r,i,s,a,f=t.substring(n,n+Math.floor(t.length/4)),l=-1,h="";-1!=(l=e.indexOf(f,l+1));){var u=o.diff_commonPrefix(t.substring(n),e.substring(l)),c=o.diff_commonSuffix(t.substring(0,n),e.substring(0,l));h.length<c+u&&(h=e.substring(l-c,l)+e.substring(l,l+u),r=t.substring(0,n-c),i=t.substring(n+u),s=e.substring(0,l-c),a=e.substring(l+u))}return 2*h.length>=t.length?[r,i,s,a,h]:null}if(this.Diff_Timeout<=0)return null;var r=t.length>e.length?t:e,i=t.length>e.length?e:t;if(r.length<4||2*i.length<r.length)return null;var s,o=this,a=n(r,i,Math.ceil(r.length/4)),f=n(r,i,Math.ceil(r.length/2));if(!a&&!f)return null;s=f?a&&a[4].length>f[4].length?a:f:a;var l,h,u,c;t.length>e.length?(l=s[0],h=s[1],u=s[2],c=s[3]):(u=s[0],c=s[1],l=s[2],h=s[3]);var p=s[4];return[l,h,u,c,p]},t.prototype.diff_cleanupSemantic=function(t){for(var i=!1,s=[],o=0,a=null,f=0,l=0,h=0,u=0,c=0;f<t.length;)t[f][0]==r?(s[o++]=f,l=u,h=c,u=0,c=0,a=t[f][1]):(t[f][0]==n?u+=t[f][1].length:c+=t[f][1].length,null!==a&&a.length<=Math.max(l,h)&&a.length<=Math.max(u,c)&&(t.splice(s[o-1],0,[e,a]),t[s[o-1]+1][0]=n,o--,o--,f=o>0?s[o-1]:-1,l=0,h=0,u=0,c=0,a=null,i=!0)),f++;for(i&&this.diff_cleanupMerge(t),this.diff_cleanupSemanticLossless(t),f=1;f<t.length;){if(t[f-1][0]==e&&t[f][0]==n){var p=t[f-1][1],d=t[f][1],g=this.diff_commonOverlap_(p,d);(g>=p.length/2||g>=d.length/2)&&(t.splice(f,0,[r,d.substring(0,g)]),t[f-1][1]=p.substring(0,p.length-g),t[f+1][1]=d.substring(g),f++),f++}f++}},t.prototype.diff_cleanupSemanticLossless=function(t){function e(t,e){if(!t||!e)return 5;var r=0;return(t.charAt(t.length-1).match(n)||e.charAt(0).match(n))&&(r++,(t.charAt(t.length-1).match(i)||e.charAt(0).match(i))&&(r++,(t.charAt(t.length-1).match(s)||e.charAt(0).match(s))&&(r++,(t.match(o)||e.match(a))&&r++))),r}for(var n=/[^a-zA-Z0-9]/,i=/\s/,s=/[\r\n]/,o=/\n\r?\n$/,a=/^\r?\n\r?\n/,f=1;f<t.length-1;){if(t[f-1][0]==r&&t[f+1][0]==r){var l=t[f-1][1],h=t[f][1],u=t[f+1][1],c=this.diff_commonSuffix(l,h);if(c){var p=h.substring(h.length-c);l=l.substring(0,l.length-c),h=p+h.substring(0,h.length-c),u=p+u}for(var d=l,g=h,v=u,m=e(l,h)+e(h,u);h.charAt(0)===u.charAt(0);){l+=h.charAt(0),h=h.substring(1)+u.charAt(0),u=u.substring(1);var y=e(l,h)+e(h,u);y>=m&&(m=y,d=l,g=h,v=u)}t[f-1][1]!=d&&(d?t[f-1][1]=d:(t.splice(f-1,1),f--),t[f][1]=g,v?t[f+1][1]=v:(t.splice(f+1,1),f--))}f++}},t.prototype.diff_cleanupEfficiency=function(t){for(var i=!1,s=[],o=0,a="",f=0,l=!1,h=!1,u=!1,c=!1;f<t.length;)t[f][0]==r?(t[f][1].length<this.Diff_EditCost&&(u||c)?(s[o++]=f,l=u,h=c,a=t[f][1]):(o=0,a=""),u=c=!1):(t[f][0]==e?c=!0:u=!0,a&&(l&&h&&u&&c||a.length<this.Diff_EditCost/2&&l+h+u+c==3)&&(t.splice(s[o-1],0,[e,a]),t[s[o-1]+1][0]=n,o--,a="",l&&h?(u=c=!0,o=0):(o--,f=o>0?s[o-1]:-1,u=c=!1),i=!0)),f++;i&&this.diff_cleanupMerge(t)},t.prototype.diff_cleanupMerge=function(t){t.push([r,""]);for(var i,s=0,o=0,a=0,f="",l="";s<t.length;)switch(t[s][0]){case n:a++,l+=t[s][1],s++;break;case e:o++,f+=t[s][1],s++;break;case r:o+a>1?(0!==o&&0!==a&&(i=this.diff_commonPrefix(l,f),0!==i&&(s-o-a>0&&t[s-o-a-1][0]==r?t[s-o-a-1][1]+=l.substring(0,i):(t.splice(0,0,[r,l.substring(0,i)]),s++),l=l.substring(i),f=f.substring(i)),i=this.diff_commonSuffix(l,f),0!==i&&(t[s][1]=l.substring(l.length-i)+t[s][1],l=l.substring(0,l.length-i),f=f.substring(0,f.length-i))),0===o?t.splice(s-o-a,o+a,[n,l]):0===a?t.splice(s-o-a,o+a,[e,f]):t.splice(s-o-a,o+a,[e,f],[n,l]),s=s-o-a+(o?1:0)+(a?1:0)+1):0!==s&&t[s-1][0]==r?(t[s-1][1]+=t[s][1],t.splice(s,1)):s++,a=0,o=0,f="",l=""}""===t[t.length-1][1]&&t.pop();var h=!1;for(s=1;s<t.length-1;)t[s-1][0]==r&&t[s+1][0]==r&&(t[s][1].substring(t[s][1].length-t[s-1][1].length)==t[s-1][1]?(t[s][1]=t[s-1][1]+t[s][1].substring(0,t[s][1].length-t[s-1][1].length),t[s+1][1]=t[s-1][1]+t[s+1][1],t.splice(s-1,1),h=!0):t[s][1].substring(0,t[s+1][1].length)==t[s+1][1]&&(t[s-1][1]+=t[s+1][1],t[s][1]=t[s][1].substring(t[s+1][1].length)+t[s+1][1],t.splice(s+1,1),h=!0)),s++;h&&this.diff_cleanupMerge(t)},t.prototype.diff_xIndex=function(t,r){var i,s=0,o=0,a=0,f=0;for(i=0;i<t.length&&(t[i][0]!==n&&(s+=t[i][1].length),t[i][0]!==e&&(o+=t[i][1].length),!(s>r));i++)a=s,f=o;return t.length!=i&&t[i][0]===e?f:f+(r-a)},t.prototype.diff_prettyHtml=function(t){for(var i=[],s=0,o=/&/g,a=/</g,f=/>/g,l=/\n/g,h=0;h<t.length;h++){var u=t[h][0],c=t[h][1],p=c.replace(o,"&amp;").replace(a,"&lt;").replace(f,"&gt;").replace(l,"&para;<br>");switch(u){case n:i[h]='<ins style="background:#e6ffe6;">'+p+"</ins>";break;case e:i[h]='<del style="background:#ffe6e6;">'+p+"</del>";break;case r:i[h]="<span>"+p+"</span>"}u!==e&&(s+=c.length)}return i.join("")},t.prototype.diff_text1=function(t){for(var e=[],r=0;r<t.length;r++)t[r][0]!==n&&(e[r]=t[r][1]);return e.join("")},t.prototype.diff_text2=function(t){for(var n=[],r=0;r<t.length;r++)t[r][0]!==e&&(n[r]=t[r][1]);return n.join("")},t.prototype.diff_levenshtein=function(t){for(var i=0,s=0,o=0,a=0;a<t.length;a++){var f=t[a][0],l=t[a][1];switch(f){case n:s+=l.length;break;case e:o+=l.length;break;case r:i+=Math.max(s,o),s=0,o=0}}return i+=Math.max(s,o)},t.prototype.diff_toDelta=function(t){for(var i=[],s=0;s<t.length;s++)switch(t[s][0]){case n:i[s]="+"+encodeURI(t[s][1]);break;case e:i[s]="-"+t[s][1].length;break;case r:i[s]="="+t[s][1].length}return i.join("	").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(t,i){for(var s=[],o=0,a=0,f=i.split(/\t/g),l=0;l<f.length;l++){var h=f[l].substring(1);switch(f[l].charAt(0)){case"+":try{s[o++]=[n,decodeURI(h)]}catch(u){throw new Error("Illegal escape in diff_fromDelta: "+h)}break;case"-":case"=":var c=parseInt(h,10);if(isNaN(c)||0>c)throw new Error("Invalid number in diff_fromDelta: "+h);var p=t.substring(a,a+=c);s[o++]="="==f[l].charAt(0)?[r,p]:[e,p];break;default:if(f[l])throw new Error("Invalid diff operation in diff_fromDelta: "+f[l])}}if(a!=t.length)throw new Error("Delta length ("+a+") does not equal source text length ("+t.length+").");return s},t.prototype.match_main=function(t,e,n){if(null==t||null==e||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,t.length)),t==e?0:t.length?t.substring(n,n+e.length)==e?n:this.match_bitap_(t,e,n):-1},t.prototype.match_bitap_=function(t,e,n){function r(t,r){var i=t/e.length,o=Math.abs(n-r);return s.Match_Distance?i+o/s.Match_Distance:o?1:i}if(e.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(e),s=this,o=this.Match_Threshold,a=t.indexOf(e,n);-1!=a&&(o=Math.min(r(0,a),o),a=t.lastIndexOf(e,n+e.length),-1!=a&&(o=Math.min(r(0,a),o)));var f=1<<e.length-1;a=-1;for(var l,h,u,c=e.length+t.length,p=0;p<e.length;p++){for(l=0,h=c;h>l;)r(p,n+h)<=o?l=h:c=h,h=Math.floor((c-l)/2+l);c=h;var d=Math.max(1,n-h+1),g=Math.min(n+h,t.length)+e.length,v=Array(g+2);v[g+1]=(1<<p)-1;for(var m=g;m>=d;m--){var y=i[t.charAt(m-1)];if(v[m]=0===p?(v[m+1]<<1|1)&y:(v[m+1]<<1|1)&y|((u[m+1]|u[m])<<1|1)|u[m+1],v[m]&f){var _=r(p,m-1);if(o>=_){if(o=_,a=m-1,!(a>n))break;d=Math.max(1,2*n-a)}}}if(r(p+1,n)>o)break;u=v}return a},t.prototype.match_alphabet_=function(t){for(var e={},n=0;n<t.length;n++)e[t.charAt(n)]=0;for(var n=0;n<t.length;n++)e[t.charAt(n)]|=1<<t.length-n-1;return e},t.prototype.patch_addContext_=function(t,e){if(0!=e.length){for(var n=e.substring(t.start2,t.start2+t.length1),i=0;e.indexOf(n)!=e.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)i+=this.Patch_Margin,n=e.substring(t.start2-i,t.start2+t.length1+i);i+=this.Patch_Margin;var s=e.substring(t.start2-i,t.start2);s&&t.diffs.unshift([r,s]);var o=e.substring(t.start2+t.length1,t.start2+t.length1+i);o&&t.diffs.push([r,o]),t.start1-=s.length,t.start2-=s.length,t.length1+=s.length+o.length,t.length2+=s.length+o.length}},t.prototype.patch_make=function(i,s,o){var a,f;if("string"==typeof i&&"string"==typeof s&&"undefined"==typeof o)a=i,f=this.diff_main(a,s,!0),f.length>2&&(this.diff_cleanupSemantic(f),this.diff_cleanupEfficiency(f));else if(i&&"object"==typeof i&&"undefined"==typeof s&&"undefined"==typeof o)f=i,a=this.diff_text1(f);else if("string"==typeof i&&s&&"object"==typeof s&&"undefined"==typeof o)a=i,f=s;else{if("string"!=typeof i||"string"!=typeof s||!o||"object"!=typeof o)throw new Error("Unknown call format to patch_make.");a=i,f=o}if(0===f.length)return[];for(var l=[],h=new t.patch_obj,u=0,c=0,p=0,d=a,g=a,v=0;v<f.length;v++){var m=f[v][0],y=f[v][1];switch(u||m===r||(h.start1=c,h.start2=p),m){case n:h.diffs[u++]=f[v],h.length2+=y.length,g=g.substring(0,p)+y+g.substring(p);break;case e:h.length1+=y.length,h.diffs[u++]=f[v],g=g.substring(0,p)+g.substring(p+y.length);break;case r:y.length<=2*this.Patch_Margin&&u&&f.length!=v+1?(h.diffs[u++]=f[v],h.length1+=y.length,h.length2+=y.length):y.length>=2*this.Patch_Margin&&u&&(this.patch_addContext_(h,d),l.push(h),h=new t.patch_obj,u=0,d=g,c=p)}m!==n&&(c+=y.length),m!==e&&(p+=y.length)}return u&&(this.patch_addContext_(h,d),l.push(h)),l},t.prototype.patch_deepCopy=function(e){for(var n=[],r=0;r<e.length;r++){var i=e[r],s=new t.patch_obj;s.diffs=[];for(var o=0;o<i.diffs.length;o++)s.diffs[o]=i.diffs[o].slice();s.start1=i.start1,s.start2=i.start2,s.length1=i.length1,s.length2=i.length2,n[r]=s}return n},t.prototype.patch_apply=function(t,i){if(0==t.length)return[i,[]];t=this.patch_deepCopy(t);var s=this.patch_addPadding(t);i=s+i+s,this.patch_splitMax(t);for(var o=0,a=[],f=0;f<t.length;f++){var l,h=t[f].start2+o,u=this.diff_text1(t[f].diffs),c=-1;if(u.length>this.Match_MaxBits?(l=this.match_main(i,u.substring(0,this.Match_MaxBits),h),-1!=l&&(c=this.match_main(i,u.substring(u.length-this.Match_MaxBits),h+u.length-this.Match_MaxBits),(-1==c||l>=c)&&(l=-1))):l=this.match_main(i,u,h),-1==l)a[f]=!1,o-=t[f].length2-t[f].length1;else{a[f]=!0,o=l-h;var p;if(p=-1==c?i.substring(l,l+u.length):i.substring(l,c+this.Match_MaxBits),u==p)i=i.substring(0,l)+this.diff_text2(t[f].diffs)+i.substring(l+u.length);else{var d=this.diff_main(u,p,!1);if(u.length>this.Match_MaxBits&&this.diff_levenshtein(d)/u.length>this.Patch_DeleteThreshold)a[f]=!1;else{this.diff_cleanupSemanticLossless(d);for(var g,v=0,m=0;m<t[f].diffs.length;m++){var y=t[f].diffs[m];y[0]!==r&&(g=this.diff_xIndex(d,v)),y[0]===n?i=i.substring(0,l+g)+y[1]+i.substring(l+g):y[0]===e&&(i=i.substring(0,l+g)+i.substring(l+this.diff_xIndex(d,v+y[1].length))),y[0]!==e&&(v+=y[1].length)}}}}}return i=i.substring(s.length,i.length-s.length),[i,a]},t.prototype.patch_addPadding=function(t){for(var e=this.Patch_Margin,n="",i=1;e>=i;i++)n+=String.fromCharCode(i);for(var i=0;i<t.length;i++)t[i].start1+=e,t[i].start2+=e;var s=t[0],o=s.diffs;if(0==o.length||o[0][0]!=r)o.unshift([r,n]),s.start1-=e,s.start2-=e,s.length1+=e,s.length2+=e;else if(e>o[0][1].length){var a=e-o[0][1].length;o[0][1]=n.substring(o[0][1].length)+o[0][1],s.start1-=a,s.start2-=a,s.length1+=a,s.length2+=a}if(s=t[t.length-1],o=s.diffs,0==o.length||o[o.length-1][0]!=r)o.push([r,n]),s.length1+=e,s.length2+=e;else if(e>o[o.length-1][1].length){var a=e-o[o.length-1][1].length;o[o.length-1][1]+=n.substring(0,a),s.length1+=a,s.length2+=a}return n},t.prototype.patch_splitMax=function(i){for(var s=this.Match_MaxBits,o=0;o<i.length;o++)if(i[o].length1>s){var a=i[o];i.splice(o--,1);for(var f=a.start1,l=a.start2,h="";0!==a.diffs.length;){var u=new t.patch_obj,c=!0;for(u.start1=f-h.length,u.start2=l-h.length,""!==h&&(u.length1=u.length2=h.length,u.diffs.push([r,h]));0!==a.diffs.length&&u.length1<s-this.Patch_Margin;){var p=a.diffs[0][0],d=a.diffs[0][1];p===n?(u.length2+=d.length,l+=d.length,u.diffs.push(a.diffs.shift()),c=!1):p===e&&1==u.diffs.length&&u.diffs[0][0]==r&&d.length>2*s?(u.length1+=d.length,f+=d.length,c=!1,u.diffs.push([p,d]),a.diffs.shift()):(d=d.substring(0,s-u.length1-this.Patch_Margin),u.length1+=d.length,f+=d.length,p===r?(u.length2+=d.length,l+=d.length):c=!1,u.diffs.push([p,d]),d==a.diffs[0][1]?a.diffs.shift():a.diffs[0][1]=a.diffs[0][1].substring(d.length))}h=this.diff_text2(u.diffs),h=h.substring(h.length-this.Patch_Margin);var g=this.diff_text1(a.diffs).substring(0,this.Patch_Margin);""!==g&&(u.length1+=g.length,u.length2+=g.length,0!==u.diffs.length&&u.diffs[u.diffs.length-1][0]===r?u.diffs[u.diffs.length-1][1]+=g:u.diffs.push([r,g])),c||i.splice(++o,0,u)}}},t.prototype.patch_toText=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=t[n];return e.join("")},t.prototype.patch_fromText=function(i){var s=[];if(!i)return s;for(var o=i.split("\n"),a=0,f=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;a<o.length;){var l=o[a].match(f);if(!l)throw new Error("Invalid patch string: "+o[a]);var h=new t.patch_obj;for(s.push(h),h.start1=parseInt(l[1],10),""===l[2]?(h.start1--,h.length1=1):"0"==l[2]?h.length1=0:(h.start1--,h.length1=parseInt(l[2],10)),h.start2=parseInt(l[3],10),""===l[4]?(h.start2--,h.length2=1):"0"==l[4]?h.length2=0:(h.start2--,h.length2=parseInt(l[4],10)),a++;a<o.length;){var u=o[a].charAt(0);try{var c=decodeURI(o[a].substring(1))}catch(p){throw new Error("Illegal escape in patch_fromText: "+c)}if("-"==u)h.diffs.push([e,c]);else if("+"==u)h.diffs.push([n,c]);else if(" "==u)h.diffs.push([r,c]);else{if("@"==u)break;if(""!==u)throw new Error('Invalid patch mode "'+u+'" in: '+c)}a++}}return s},t.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},t.patch_obj.prototype.toString=function(){var t,i;t=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,i=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var s,o=["@@ -"+t+" +"+i+" @@\n"],a=0;a<this.diffs.length;a++){switch(this.diffs[a][0]){case n:s="+";break;case e:s="-";break;case r:s=" "}o[a+1]=s+encodeURI(this.diffs[a][1])+"\n"}return o.join("").replace(/%20/g," ")},this.diff_match_patch=t,this.DIFF_DELETE=e,this.DIFF_INSERT=n,this.DIFF_EQUAL=r},{}],7:[function(t,e,n){var r=t("../pipe").Pipe,i=function(){};i.prototype.setResult=function(t){return this.result=t,this.hasResult=!0,this},i.prototype.exit=function(){return this.exiting=!0,this},i.prototype.switchTo=function(t,e){return"string"==typeof t||t instanceof r?this.nextPipe=t:(this.next=t,e&&(this.nextPipe=e)),this},i.prototype.push=function(t,e){return t.parent=this,"undefined"!=typeof e&&(t.childName=e),t.root=this.root||this,t.options=t.options||this.options,this.children?(this.children[this.children.length-1].next=t,this.children.push(t)):(this.children=[t],this.nextAfterChildren=this.next||null,this.next=t),t.next=this,this},n.Context=i},{"../pipe":20}],8:[function(t,e,n){var r=t("./context").Context,i=function(t,e){this.left=t,this.right=e,this.pipe="diff"};i.prototype=new r,n.DiffContext=i},{"./context":7}],9:[function(t,e,n){var r=t("./context").Context,i=function(t,e){this.left=t,this.delta=e,this.pipe="patch"};i.prototype=new r,n.PatchContext=i},{"./context":7}],10:[function(t,e,n){var r=t("./context").Context,i=function(t){this.delta=t,this.pipe="reverse"};i.prototype=new r,n.ReverseContext=i},{"./context":7}],11:[function(t,e){e.exports=function(t,e){var n;return"string"==typeof e&&(n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+\-])(\d{2}):(\d{2}))$/.exec(e))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6],+(n[7]||0))):e}},{}],12:[function(t,e,n){var r=t("./processor").Processor,i=t("./pipe").Pipe,s=t("./contexts/diff").DiffContext,o=t("./contexts/patch").PatchContext,a=t("./contexts/reverse").ReverseContext,f=t("./filters/trivial"),l=t("./filters/nested"),h=t("./filters/arrays"),u=t("./filters/dates"),c=t("./filters/texts"),p=function(t){this.processor=new r(t),this.processor.pipe(new i("diff").append(l.collectChildrenDiffFilter,f.diffFilter,u.diffFilter,c.diffFilter,l.objectsDiffFilter,h.diffFilter).shouldHaveResult()),this.processor.pipe(new i("patch").append(l.collectChildrenPatchFilter,h.collectChildrenPatchFilter,f.patchFilter,c.patchFilter,l.patchFilter,h.patchFilter).shouldHaveResult()),this.processor.pipe(new i("reverse").append(l.collectChildrenReverseFilter,h.collectChildrenReverseFilter,f.reverseFilter,c.reverseFilter,l.reverseFilter,h.reverseFilter).shouldHaveResult())
};p.prototype.options=function(){return this.processor.options.apply(this.processor,arguments)},p.prototype.diff=function(t,e){return this.processor.process(new s(t,e))},p.prototype.patch=function(t,e){return this.processor.process(new o(t,e))},p.prototype.reverse=function(t){return this.processor.process(new a(t))},p.prototype.unpatch=function(t,e){return this.patch(t,this.reverse(e))},n.DiffPatcher=p},{"./contexts/diff":8,"./contexts/patch":9,"./contexts/reverse":10,"./filters/arrays":13,"./filters/dates":14,"./filters/nested":16,"./filters/texts":17,"./filters/trivial":18,"./pipe":20,"./processor":21}],13:[function(t,e,n){var r=t("../contexts/diff").DiffContext,i=t("../contexts/patch").PatchContext,s=t("../contexts/reverse").ReverseContext,o=t("./lcs"),a=3,f="function"==typeof Array.isArray?Array.isArray:function(t){return t instanceof Array},l="function"==typeof Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var n=t.length,r=0;n>r;r++)if(t[r]===e)return r;return-1},h=function(t){if(t.leftIsArray){for(var e,n,i,s,f=t.options&&t.options.objectHash,h=function(t,e,n,r,i){var s=t[n],o=e[r];if(s===o)return!0;if("object"!=typeof s||"object"!=typeof o)return!1;if(!f)return!1;var a,l;return"number"==typeof n?(i.hashCache1=i.hashCache1||[],a=i.hashCache1[n],"undefined"==typeof a&&(i.hashCache1[n]=a=f(s,n))):a=f(s),"undefined"==typeof a?!1:("number"==typeof r?(i.hashCache2=i.hashCache2||[],l=i.hashCache2[r],"undefined"==typeof l&&(i.hashCache2[r]=l=f(o,r))):l=f(o),"undefined"==typeof l?!1:a===l)},u={},c=0,p=0,d=t.left,g=t.right,v=d.length,m=g.length;v>c&&m>c&&h(d,g,c,c,u);)e=c,s=new r(t.left[e],t.right[e]),t.push(s,e),c++;for(;v>p+c&&m>p+c&&h(d,g,v-1-p,m-1-p,u);)n=v-1-p,i=m-1-p,s=new r(t.left[n],t.right[i]),t.push(s,i),p++;var y;if(c+p===v){if(v===m)return void t.setResult(void 0).exit();for(y=y||{_t:"a"},e=c;m-p>e;e++)y[e]=[g[e]];return void t.setResult(y).exit()}if(c+p===m){for(y=y||{_t:"a"},e=c;v-p>e;e++)y["_"+e]=[d[e],0,0];return void t.setResult(y).exit()}u={};var _=d.slice(c,v-p),b=g.slice(c,m-p),x=o.get(_,b,h,u),w=[];for(y=y||{_t:"a"},e=c;v-p>e;e++)l(x.indices1,e-c)<0&&(y["_"+e]=[d[e],0,0],w.push(e));var R=!0;t.options&&t.options.arrays&&t.options.arrays.detectMove===!1&&(R=!1);var M=!1;t.options&&t.options.arrays&&t.options.arrays.includeValueOnMove&&(M=!0);var C=w.length;for(e=c;m-p>e;e++){var E=l(x.indices2,e-c);if(0>E){var A=!1;if(R&&C>0)for(n=0;C>n;n++)if(h(_,b,w[n]-c,e-c,u)){y["_"+w[n]].splice(1,2,e,a),M||(y["_"+w[n]][0]=""),n=w[n],i=e,s=new r(t.left[n],t.right[i]),t.push(s,i),w.splice(n,1),A=!0;break}A||(y[e]=[g[e]])}else n=x.indices1[E]+c,i=x.indices2[E]+c,s=new r(t.left[n],t.right[i]),t.push(s,i)}t.setResult(y).exit()}};h.filterName="arrays";var u={numerically:function(t,e){return t-e},numericallyBy:function(t){return function(e,n){return e[t]-n[t]}}},c=function(t){if(t.nested&&"a"===t.delta._t){var e,n,r=t.delta,s=t.left,o=[],f=[],l=[];for(e in r)if("_t"!==e)if("_"===e[0]){if(0!==r[e][2]&&r[e][2]!==a)throw new Error("only removal or move can be applied at original array indices, invalid diff type: "+r[e][2]);o.push(parseInt(e.slice(1),10))}else 1===r[e].length?f.push({index:parseInt(e,10),value:r[e][0]}):l.push({index:parseInt(e,10),delta:r[e]});for(o=o.sort(u.numerically),e=o.length-1;e>=0;e--){n=o[e];var h=r["_"+n],c=s.splice(n,1)[0];h[2]===a&&f.push({index:h[1],value:c})}f=f.sort(u.numericallyBy("index"));var p=f.length;for(e=0;p>e;e++){var d=f[e];s.splice(d.index,0,d.value)}var g,v=l.length;if(v>0)for(e=0;v>e;e++){var m=l[e];g=new i(t.left[m.index],m.delta),t.push(g,m.index)}return t.children?void t.exit():void t.setResult(t.left).exit()}};c.filterName="arrays";var p=function(t){if(t&&t.children&&"a"===t.delta._t){for(var e,n=t.children.length,r=0;n>r;r++)e=t.children[r],t.left[e.childName]=e.result;t.setResult(t.left).exit()}};p.filterName="arraysCollectChildren";var d=function(t){if(!t.nested)return void(t.delta[2]===a&&(t.newName="_"+t.delta[1],t.setResult([t.delta[0],parseInt(t.childName.substr(1),10),a]).exit()));if("a"===t.delta._t){var e,n;for(e in t.delta)"_t"!==e&&(n=new s(t.delta[e]),t.push(n,e));t.exit()}};d.filterName="arrays";var g=function(t,e,n){var r=e;if("string"==typeof e&&"_"===e[0])r=parseInt(e.substr(1),10);else{var i="_"+e;if(f(n)&&0===n[2])r=i;else for(var s in t){var o=t[s];f(o)&&o[2]===a&&o[1].toString()===e&&(r=s.substr(1))}}return r},v=function(t){if(t&&t.children&&"a"===t.delta._t){for(var e,n=t.children.length,r={_t:"a"},i=0;n>i;i++){e=t.children[i];var s=e.newName;"undefined"==typeof s&&(s=g(t.delta,e.childName,e.result)),r[s]!==e.result&&(r[s]=e.result)}t.setResult(r).exit()}};v.filterName="arraysCollectChildren",n.diffFilter=h,n.patchFilter=c,n.collectChildrenPatchFilter=p,n.reverseFilter=d,n.collectChildrenReverseFilter=v},{"../contexts/diff":8,"../contexts/patch":9,"../contexts/reverse":10,"./lcs":15}],14:[function(t,e,n){var r=function(t){t.left instanceof Date?(t.setResult(t.right instanceof Date?t.left.getTime()!==t.right.getTime()?[t.left,t.right]:void 0:[t.left,t.right]),t.exit()):t.right instanceof Date&&t.setResult([t.left,t.right]).exit()};r.filterName="dates",n.diffFilter=r},{}],15:[function(t,e,n){var r=function(t,e,n,r){return t[n]===e[r]},i=function(t,e,n,r){var i,s,o=t.length,a=e.length,f=[o+1];for(i=0;o+1>i;i++)for(f[i]=[a+1],s=0;a+1>s;s++)f[i][s]=0;for(f.match=n,i=1;o+1>i;i++)for(s=1;a+1>s;s++)f[i][s]=n(t,e,i-1,s-1,r)?f[i-1][s-1]+1:Math.max(f[i-1][s],f[i][s-1]);return f},s=function(t,e,n,r,i,o){if(0===r||0===i)return{sequence:[],indices1:[],indices2:[]};if(t.match(e,n,r-1,i-1,o)){var a=s(t,e,n,r-1,i-1,o);return a.sequence.push(e[r-1]),a.indices1.push(r-1),a.indices2.push(i-1),a}return t[r][i-1]>t[r-1][i]?s(t,e,n,r,i-1,o):s(t,e,n,r-1,i,o)},o=function(t,e,n,o){o=o||{};var a=i(t,e,n||r,o),f=s(a,t,e,t.length,e.length,o);return"string"==typeof t&&"string"==typeof e&&(f.sequence=f.sequence.join("")),f};n.get=o},{}],16:[function(t,e,n){var r=t("../contexts/diff").DiffContext,i=t("../contexts/patch").PatchContext,s=t("../contexts/reverse").ReverseContext,o=function(t){if(t&&t.children){for(var e,n=t.children.length,r=t.result,i=0;n>i;i++)e=t.children[i],"undefined"!=typeof e.result&&(r=r||{},r[e.childName]=e.result);r&&t.leftIsArray&&(r._t="a"),t.setResult(r).exit()}};o.filterName="collectChildren";var a=function(t){if(!t.leftIsArray&&"object"===t.leftType){var e,n;for(e in t.left)n=new r(t.left[e],t.right[e]),t.push(n,e);for(e in t.right)"undefined"==typeof t.left[e]&&(n=new r(void 0,t.right[e]),t.push(n,e));return t.children&&0!==t.children.length?void t.exit():void t.setResult(void 0).exit()}};a.filterName="objects";var f=function(t){if(t.nested&&!t.delta._t){var e,n;for(e in t.delta)n=new i(t.left[e],t.delta[e]),t.push(n,e);t.exit()}};f.filterName="objects";var l=function(t){if(t&&t.children&&!t.delta._t){for(var e,n=t.children.length,r=0;n>r;r++)e=t.children[r],t.left[e.childName]!==e.result&&(t.left[e.childName]=e.result);t.setResult(t.left).exit()}};l.filterName="collectChildren";var h=function(t){if(t.nested&&!t.delta._t){var e,n;for(e in t.delta)n=new s(t.delta[e]),t.push(n,e);t.exit()}};h.filterName="objects";var u=function(t){if(t&&t.children&&!t.delta._t){for(var e,n=t.children.length,r={},i=0;n>i;i++)e=t.children[i],r[e.childName]!==e.result&&(r[e.childName]=e.result);t.setResult(r).exit()}};u.filterName="collectChildren",n.collectChildrenDiffFilter=o,n.objectsDiffFilter=a,n.patchFilter=f,n.collectChildrenPatchFilter=l,n.reverseFilter=h,n.collectChildrenReverseFilter=u},{"../contexts/diff":8,"../contexts/patch":9,"../contexts/reverse":10}],17:[function(t,e,n){var r=2,i=60,s=null,o=function(){if(!s){var e;if("undefined"!=typeof diff_match_patch)e=new diff_match_patch;else if("function"==typeof t){var n=t("../../external/diff_match_patch_uncompressed");e=new n.diff_match_patch}if(!e){var r=new Error("text diff_match_patch library not found");throw r.diff_match_patch_not_found=!0,r}s={diff:function(t,n){return e.patch_toText(e.patch_make(t,n))},patch:function(t,n){for(var r=e.patch_apply(e.patch_fromText(n),t),i=0;i<r[1].length;i++)if(!r[1][i]){var s=new Error("text patch failed");s.textPatchFailed=!0}return r[0]}}}return s},a=function(t){if("string"===t.leftType){var e=t.options&&t.options.textDiff&&t.options.textDiff.minLength||i;if(t.left.length<e||t.right.length<e)return void t.setResult([t.left,t.right]).exit();var n=o().diff;t.setResult([n(t.left,t.right),0,r]).exit()}};a.filterName="texts";var f=function(t){if(!t.nested&&t.delta[2]===r){var e=o().patch;t.setResult(e(t.left,t.delta[0])).exit()}};f.filterName="texts";var l=function(t){var e,n,r,i,s,o,a,f,l=null,h=/^@@ +\-(\d+),(\d+) +\+(\d+),(\d+) +@@$/;for(r=t.split("\n"),e=0,n=r.length;n>e;e++){i=r[e];var u=i.slice(0,1);"@"===u?(l=h.exec(i),o=e,a=null,f=null,r[o]="@@ -"+l[3]+","+l[4]+" +"+l[1]+","+l[2]+" @@"):"+"===u?(a=e,r[e]="-"+r[e].slice(1),"+"===r[e-1].slice(0,1)&&(s=r[e],r[e]=r[e-1],r[e-1]=s)):"-"===u&&(f=e,r[e]="+"+r[e].slice(1))}return r.join("\n")},h=function(t){t.nested||t.delta[2]===r&&t.setResult([l(t.delta[0]),0,r]).exit()};h.filterName="texts",n.diffFilter=a,n.patchFilter=f,n.reverseFilter=h},{"../../external/diff_match_patch_uncompressed":6}],18:[function(t,e,n){var r="function"==typeof Array.isArray?Array.isArray:function(t){return t instanceof Array},i=function(t){if(t.left===t.right)return void t.setResult(void 0).exit();if("undefined"==typeof t.left){if("function"==typeof t.right)throw new Error("functions are not supported");return void t.setResult([t.right]).exit()}if("undefined"==typeof t.right)return void t.setResult([t.left,0,0]).exit();if("function"==typeof t.left||"function"==typeof t.right)throw new Error("functions are not supported");return t.leftType=null===t.left?"null":typeof t.left,t.rightType=null===t.right?"null":typeof t.right,t.leftType!==t.rightType?void t.setResult([t.left,t.right]).exit():"boolean"===t.leftType||"number"===t.leftType?void t.setResult([t.left,t.right]).exit():("object"===t.leftType&&(t.leftIsArray=r(t.left)),"object"===t.rightType&&(t.rightIsArray=r(t.right)),t.leftIsArray!==t.rightIsArray?void t.setResult([t.left,t.right]).exit():void 0)};i.filterName="trivial";var s=function(t){return"undefined"==typeof t.delta?void t.setResult(t.left).exit():(t.nested=!r(t.delta),t.nested?void 0:1===t.delta.length?void t.setResult(t.delta[0]).exit():2===t.delta.length?void t.setResult(t.delta[1]).exit():3===t.delta.length&&0===t.delta[2]?void t.setResult(void 0).exit():void 0)};s.filterName="trivial";var o=function(t){return"undefined"==typeof t.delta?void t.setResult(t.delta).exit():(t.nested=!r(t.delta),t.nested?void 0:1===t.delta.length?void t.setResult([t.delta[0],0,0]).exit():2===t.delta.length?void t.setResult([t.delta[1],t.delta[0]]).exit():3===t.delta.length&&0===t.delta[2]?void t.setResult([t.delta[0]]).exit():void 0)};o.filterName="trivial",n.diffFilter=i,n.patchFilter=s,n.reverseFilter=o},{}],19:[function(t,e,n){(function(e){var r=t("./diffpatcher").DiffPatcher;n.DiffPatcher=r,n.create=function(t){return new r(t)},n.dateReviver=t("./date-reviver");var i;n.diff=function(){return i||(i=new r),i.diff.apply(i,arguments)},n.patch=function(){return i||(i=new r),i.patch.apply(i,arguments)},n.unpatch=function(){return i||(i=new r),i.unpatch.apply(i,arguments)},n.reverse=function(){return i||(i=new r),i.reverse.apply(i,arguments)};var s="undefined"!=typeof e&&"string"==typeof e.execPath;if(s){var o=t("./formatters/index");n.formatters=o,n.console=o.console}else n.homepage="{{package-homepage}}",n.version="{{package-version}}"}).call(this,t("1YiZ5S"))},{"./date-reviver":11,"./diffpatcher":12,"1YiZ5S":3}],20:[function(t,e,n){var r=function(t){this.name=t,this.filters=[]};r.prototype.process=function(t){if(!this.processor)throw new Error("add this pipe to a processor before using it");for(var e=this.debug,n=this.filters.length,r=t,i=0;n>i;i++){var s=this.filters[i];if(e&&this.log("filter: "+s.filterName),s(r),"object"==typeof r&&r.exiting){r.exiting=!1;break}}!r.next&&this.resultCheck&&this.resultCheck(r)},r.prototype.log=function(t){console.log("[jsondiffpatch] "+this.name+" pipe, "+t)},r.prototype.append=function(){return this.filters.push.apply(this.filters,arguments),this},r.prototype.prepend=function(){return this.filters.unshift.apply(this.filters,arguments),this},r.prototype.indexOf=function(t){if(!t)throw new Error("a filter name is required");for(var e=0;e<this.filters.length;e++){var n=this.filters[e];if(n.filterName===t)return e}throw new Error("filter not found: "+t)},r.prototype.list=function(){for(var t=[],e=0;e<this.filters.length;e++){var n=this.filters[e];t.push(n.filterName)}return t},r.prototype.after=function(t){var e=this.indexOf(t),n=Array.prototype.slice.call(arguments,1);if(!n.length)throw new Error("a filter is required");return n.unshift(e+1,0),Array.prototype.splice.apply(this.filters,n),this},r.prototype.before=function(t){var e=this.indexOf(t),n=Array.prototype.slice.call(arguments,1);if(!n.length)throw new Error("a filter is required");return n.unshift(e,0),Array.prototype.splice.apply(this.filters,n),this},r.prototype.clear=function(){return this.filters.length=0,this},r.prototype.shouldHaveResult=function(t){if(t===!1)return void(this.resultCheck=null);if(!this.resultCheck){var e=this;return this.resultCheck=function(t){if(!t.hasResult){console.log(t);var n=new Error(e.name+" failed");throw n.noResult=!0,n}},this}},n.Pipe=r},{}],21:[function(t,e,n){var r=function(t){this.selfOptions=t,this.pipes={}};r.prototype.options=function(t){return t&&(this.selfOptions=t),this.selfOptions},r.prototype.pipe=function(t,e){if("string"==typeof t){if("undefined"==typeof e)return this.pipes[t];this.pipes[t]=e}if(t&&t.name){if(e=t,e.processor===this)return e;this.pipes[e.name]=e}return e.processor=this,e},r.prototype.process=function(t,e){var n=t;n.options=this.options();for(var r,i,s=e||t.pipe||"default";s;)"undefined"!=typeof n.nextAfterChildren&&(n.next=n.nextAfterChildren,n.nextAfterChildren=null),"string"==typeof s&&(s=this.pipe(s)),s.process(n),i=n,r=s,s=null,n&&n.next&&(n=n.next,s=i.nextPipe||n.pipe||r);return n.hasResult?n.result:void 0},n.Processor=r},{}],22:[function(t,e,n){function r(t,e){this.root="undefined"==typeof t?null:t,this.version=e||0}var i=t("jsondiffpatch");r.prototype.clone=function(){var t=new r(JSON.parse(JSON.stringify(this.root),i.dateReviver),this.version);return t.url=this.url,t},r.empty=new r(null,0),r.empty.isEmpty=!0,r.notFound=new r(null,0),r.notFound.notFound=!0,n.Document=r},{jsondiffpatch:19}],23:[function(t,e,n){(function(e){var r=t("./document").Document,i=t("./peer").Peer,s=t("./storage").Storage;n.Document=r,n.Peer=i,n.Storage=s,n.jsondiffpatch=t("jsondiffpatch");var o="undefined"!=typeof e&&"string"==typeof e.execPath;o||(n.homepage="https://github.com/benjamine/dialogo",n.version="0.0.2")}).call(this,t("1YiZ5S"))},{"./document":22,"./peer":24,"./storage":25,"1YiZ5S":3,jsondiffpatch:19}],24:[function(t,e,n){function r(t,e){i.EventEmitter.call(this),t instanceof a?this.document=t:(this.name=t,this.document=e||a.empty),this.counters={messages:{sent:0,received:0}},this.createShadow(),this.watchInterval=r.defaults.watchInterval,this.debug=r.defaults.debug}var i=t("events"),s=t("jsondiffpatch"),o=t("util"),a=t("./document").Document;o.inherits(r,i.EventEmitter),r.defaults={watchInterval:100,debug:!1},r.prototype.log=function(){if(this.debug){var t=Array.prototype.slice.apply(arguments);t.unshift("[Peer "+this.name+"]"),console.log.apply(console,t)}},r.prototype.syncBroken=function(){this.synchronized&&(this.synchronized=!1,this.emit("unsync"),this.stop())},r.prototype.syncComplete=function(){this.synchronized||(this.synchronized=!0,this.log("sync complete"),this.emit("sync"),this.watch())},r.prototype.use=function(t){this.log("document loaded locally:",t.url),this.document=t,this.createShadow(),this.emit("loaded");var e=this.documentRequest;e&&(this.documentRequest=null,e.callback&&e.callback()),this.syncComplete()},r.prototype.load=function(t,e,n){var r=e||{},i=this;if("function"==typeof e&&(n=e,r={}),this.documentRequest={url:t,options:r,callback:n},r&&r.local){if(this.emit("load",t,n),!this.loading){if(this.storage)return this.loading=!0,void this.storage.get(t,r,function(t,e){return i.loading=!1,t?void n(t):void i.use(e)});this.log("no document loader for",t),n(new Error("no document loader"))}}else this.scan()},r.prototype.save=function(t,e,n){var r=e||{},i=this;if("function"==typeof e&&(n=e,r={}),this.saveRequest={url:t,options:r,callback:n},this.emit("save",t,n),!this.saving){if(this.storage)return this.saving=!0,void this.storage.put(t,this.document,e,function(t,e){return i.saving=!1,t?void n(t):(i.document.url=e,void i.saved())});this.log("no document saver for",t),n(new Error("no document saver"))}},r.prototype.saved=function(){var t=this.document;this.log("document saved locally:",t.url);var e=this.saveRequest;e&&(this.saveRequest=null,e.callback&&e.callback())},r.prototype.createShadow=function(){this.shadow=this.document.clone()},r.prototype.send=function(t){this.counters.messages.sent++,this.emit("message",t),this.lastSent=t,this.waitingResponse=!0},r.prototype.receive=function(t){var e=this;this.waitingResponse=!1,this.responding=!0,this.counters.messages.received++,t.responseTo=this.lastSent,this.respond(t,function(t,n){return t?(e.send({error:t}),void(e.responding=!1)):(n&&e.send(n),void(e.responding=!1))})},r.prototype.isBusy=function(){return this.waitingResponse||this.responding},r.prototype.scan=function(){var t=this;if(!this.responding)return!this.waitingResponse&&this.documentRequest?void(this.documentRequest.options.local||this.documentRequest.sent||(this.log("requesting document",this.documentRequest.url),this.send({load:!0,url:this.documentRequest.url,options:this.documentRequest.options}),this.documentRequest.sent=!0)):!this.waitingResponse&&this.saveRequest?void(this.saveRequest.options.local||this.saveRequest.sent||(this.log("requesting to save document as",this.saveRequest.url),this.send({save:!0,url:this.saveRequest.url,options:this.saveRequest.options}),this.saveRequest.sent=!0)):void this.getChanges(function(e){if(e){if(t.syncBroken(),t.isBusy())return t.log("ping"),void t.send({ping:!0});t.document.version++,t.createShadow(),t.send({delta:e,version:t.document.version})}})},r.prototype.watch=function(){if(!this.watchTimer){var t=this;this.watchTimer=setInterval(function(){t.isPaused||t.scan({source:"watch"})},Math.max(20,t.watchInterval)),this.log("watching...")}},r.prototype.stop=function(){this.watchTimer&&(clearInterval(this.watchTimer),this.watchTimer=null,this.log("watch stopped"))},r.prototype.pause=function(){this.isPaused||(this.isPaused=!0,this.emit("pause"))},r.prototype.resume=function(){this.isPaused&&(this.isPaused=!1,this.emit("resume"))},r.prototype.getChanges=function(t){var e=s.diff(this.shadow.root,this.document.root);e&&this.log("found changes",e),t(e)},r.prototype.respond=function(t,e){this.peerError=null;var n,r=this,i=function(){e(null,{noop:!0})};if(t.error)return this.log("got peer error: "+t.error),this.peerError=t.error,void e();if(t.delta){this.log("patching...");try{this.shadow.root=s.patch(this.shadow.root,t.delta)}catch(o){this.log("patch error: ",o)}try{this.document.root=s.patch(this.document.root,t.delta)}catch(o){this.log("patch error (best-effort): ",o)}t.version&&this.document.version<=t.version?this.document.version=t.version:this.document.version++,this.log("result:",this.document),this.emit("change")}if(t.noop&&(this.log("got noop"),t.responseTo&&t.responseTo.noop&&!this.alwaysRespondNoops))return this.syncComplete(),void e();if(t.ping&&(this.log("got ping"),this.waitingResponse))return this.log("ignoring ping, waiting a response"),void e();if(t.noop||t.delta||t.ping||t.saved)return void this.getChanges(function(n){return n?(r.document.version++,r.createShadow(),void e(null,{delta:n,version:r.document.version})):(t.noop&&r.syncComplete(),void i())});if(t.load){this.log("got document load request");var f=t.url,l=function(){var t=r.document.clone();r.watch(),e(null,{document:{root:t.root,url:t.url,version:t.version}})};if(this.document.isEmpty||f&&this.document.url!==f){this.log("loading",f);var h=t.options||{};return h.local=!0,void this.load(f,h,function(t){return t?(r.log("error loading document"),void e(null,{error:t.message,url:f})):(r.log("document loaded, sending to peer",r.document),void l())})}return this.log("sending document",this.document),void l()}return t.document?(n=this.documentRequest,n&&n.sent&&(this.documentRequest=null),t.error?(this.log("document load error"),void e()):(this.document=new a(t.document.root,t.document.version),this.document.url=t.document.url,this.createShadow(),this.log("got document",this.document),this.emit("loaded"),this.syncComplete(),e(),void(n&&n.callback&&n.callback()))):(this.log("error","unexpected message",t),void e(new Error("unexpected message")))},r.prototype.bindTo=function(t,e){var n=this;if(t&&"function"==typeof t.on){var i=Math.max(e&&e.artificialDelay,1);return t.on("message",function(t){setTimeout(function(){n.receive(t)},i)}),this.boundTo=t,void(t instanceof r&&!t.boundTo&&t.bindTo(n,e))}throw new Error("unsupported bind target")},n.Peer=r},{"./document":22,events:1,jsondiffpatch:19,util:5}],25:[function(t,e,n){function r(t){this.documents=t||{}}var i=t("./document").Document;r.prototype.get=function(t,e,n){if(!this.documents||!this.documents[t]){if(!e||!e.create){var r=new Error("document not found");return r.notFound=!0,r.url=t,void n(r)}this.documents[t]={}}var s=this.documents[t];s instanceof i||(s=this.documents[t]=new i(s)),s.url=t,n(null,s)},r.prototype.put=function(t,e,n,r){this.documents||(this.documents={}),e instanceof i||(e=new i(e)),e.url=t,this.documents[t]=e.clone(),r(null,t)},n.Storage=r},{"./document":22}]},{},[23])(23)});